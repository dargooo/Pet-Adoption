<!DOCTYPE html>
<html>
<title>PRESENT DOG</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Icons font CSS-->
<link href="/static/vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
<link href="/static/vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
<!-- Font special for pages-->
<link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">
<!-- Vendor CSS-->
<link href="/static/vendor/select2/select2.min.css" rel="stylesheet" media="all">
<link href="/static/vendor/datepicker/daterangepicker.css" rel="stylesheet" media="all">
<link href="/static/css/main.css" rel="stylesheet" media="all">
<link href="/static/css/main-2.css" rel="stylesheet" media="all">
<link href="/static/css/present.css" rel="stylesheet" media="all">
<style>
	body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
	body, html {
	  height: 100%;
	  color: #777;
	  line-height: 1.8;
	}
	.w3-wide {letter-spacing: 10px;}
	.w3-hover-opacity {cursor: pointer;}
	.cute_font {
		font-family: "Comic Sans MS", "Comic Sans", cursive;
		font-size: 40px;
		color: white;
	}
	.cute_font_sm {
        font-family: "Comic Sans MS", "Comic Sans", cursive;
        font-size: 20px;
        color: white;
    }

</style>
<body style="background-color:rgb(230,249,255);">

<!-- Navbar (sit on top) -->
<div class="w3-top">
    <div class="w3-bar" id="myNavbar">
        <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);"
           onclick="toggleFunction()" title="Toggle Navigation Menu">
            <i class="fa fa-bars"></i>
        </a>
        <a id="nav-home" href="/home" class="w3-bar-item w3-button"><i class="fa fa-th-large"></i> HOME</a>
        <a id="nav-post" href="/post" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-file-o"></i> POST</a>
        <a id="nav-find" href="/find" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-link"></i> FIND</a>
        <a id="nav-account" href="/login" class="w3-bar-item w3-button w3-hide-small"><i class="fa fa-user"></i> ACCOUNT</a>
    </div>
</div>

<!--div class="container-contact100"-->
<div class="container outline">
    <div class="content-table">
        <div class="content-row">

            <div class="column wrap-img">
                <span class="cute_font contact100-form-title" style="text-align: center;" id="present-title"></span>
                <img id="present-img" style="margin-top: 5px;"></img>
                <span class="cute_font_sm contact100-form-title" id="present-description"
                      style="text-align: center; margin-top: 30px; padding-bottom: 20px;"></span>
                <span class="cute_font_sm contact100-form-title" style="text-align: center; padding-bottom: 20px;">
					Post By:
					<a style="color:rgb(0, 119, 255);" id="present-postby"></a>
				</span>
                <span class="cute_font_sm contact100-form-title" id="present-posttime" style="text-align: center; padding-bottom: 25px;"></span>
                <span class="cute_font_sm contact100-form-title" style="text-align: center; padding-bottom: 20px;">
					Status:
					<span id="present-status"></span>
				</span>
				<div id="operations">
					<button id="btn-request" class="btn-adopt" onclick="request()">Request to Adopt</button>
					<button id="btn-contact" class="btn-adopt" onclick="dialog()">Send Message</button>
				</div>
            </div>

            <div class="column sidebar wrap-form">
                <span class="cute_font contact100-form-title">About Me</span>
                <div class="col-2">

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Name</label>
                        <label class="label-heavy" id="present-name">Simba</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Breed</label>
                        <label class="label-heavy" id="present-breed">Bull</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">gender</label>
                        <label class="label-heavy" id="present-gender">M</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Age</label>
                        <label class="label-heavy" id="present-age">12</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Color</label>
                        <label class="label-heavy" id="present-color">Orange</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Hair</label>
                        <label class="label-heavy" id="present-hair">long</label>
                    </div>


                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Weight</label>
                        <label class="label-heavy" id="present-weight">6.8</label>
                    </div>

                    <div class="present-group" style="margin-bottom: 25px;">
                        <label class="label-light">Personality</label>
                        <label class="label-heavy" id="present-personality">Sweet</label>
                    </div>
                </div>
            </div>
            <!--/div-->
        </div>
    </div>
</div>

<!-- Vendor JS-->
<script src="/static/vendor/jquery/jquery.min.js"></script>
<script src="/static/vendor/select2/select2.min.js"></script>
<script src="/static/vendor/jquery-validate/jquery.validate.min.js"></script>
<script src="/static/vendor/bootstrap-wizard/bootstrap.min.js"></script>
<script src="/static/vendor/bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
<script src="/static/vendor/datepicker/moment.min.js"></script>
<script src="/static/js/global.js"></script>
<script src='/static/js/usage.js' language='javascript'></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
        if ("{{ login }}" != "") {
            document.getElementById("nav-home").setAttribute("href", "/home/login/{{ login }}");
            document.getElementById("nav-post").setAttribute("href", "/post/login/{{ login }}");
            document.getElementById("nav-find").setAttribute("href", "/find/login/{{ login }}");
			document.getElementById("nav-account").setAttribute("href", "/userpage/{{ login }}/login/{{ login }}");
        }
</script>
<script>
		function request() {
			var receiver = document.getElementById("present-postby").innerHTML;
            var json = {
                "username": "{{ login }}",
                "pet_id":   "{{ pet_id }}"
            }

            var url = 'http://coasttocoast.web.illinois.edu';
            fetch(url + "/request", {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(json)
              }).then(function(response) {
                  console.log(JSON.stringify(json));
                  return response.json();
              }) .then(data => {
                  console.log(data);
              }).catch(error => console.log('ERROR'));

			// change pet status to pending
			 json = {
				 "pet_id": "{{ pet_id }}",
				 "status": "pending"
			 }
			 fetch(url + "/status", {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(json)
              }).then(function(response) {
                  console.log(JSON.stringify(json));
                  return response.json();
              }) .then(data => {
                  console.log(data);
              }).catch(error => console.log('ERROR'));

			alert("Your request has been sent!");

		}

		function dialog() {
 			var message = prompt("Please enter your message:", "Hi! I'm interested in adopting your pet.");
			var receiver = document.getElementById("present-postby").innerHTML;
            var json = {
                "sender":     "{{ login }}",
                "receiver":   receiver,
                "content":    message
            }

            var url = 'http://coasttocoast.web.illinois.edu';
            fetch(url + "/messages", {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(json)
              }).then(function(response) {
                  console.log(JSON.stringify(json));
                  return response.json();
              }) .then(data => {
                  console.log(data);
              }).catch(error => console.log('ERROR'));

			alert("Your message has been sent!");
			
		}

</script>
<script>
		function getPet(pet_id) {
		    var site = 'http://coasttocoast.web.illinois.edu';
		
		    // from pet
		    var url = site + '/pet?id=' + pet_id + '\&species_id=0';
		    console.log(url);
		    fetch(url)
		    .then(res => res.json())
		    .then(data => {
		        console.log(data);
		        data.forEach(obj => {
		            document.getElementById("present-name").innerHTML        = obj.name;
		            document.getElementById("present-breed").innerHTML       = obj.breed;
		            document.getElementById("present-gender").innerHTML      = obj.gender;
		            document.getElementById("present-age").innerHTML         = obj.age;
		            document.getElementById("present-color").innerHTML       = obj.color;
		            document.getElementById("present-hair").innerHTML        = obj.hair;
		            document.getElementById("present-weight").innerHTML      = obj.weight;
		            document.getElementById("present-personality").innerHTML = obj.personality;
		            if (obj.image == 'NULL') { document.getElementById("present-img").setAttribute("src", "/static/img/nophoto-dog.png"); }
		            else                   { document.getElementById("present-img").setAttribute("src", obj.image); }
					
					document.getElementById("present-status").innerHTML 	 = obj.adopt_status;
					if (obj.adopt_status == "adoptable") { document.getElementById("present-status").setAttribute("class", "labelll adoptable"); }
					else if (obj.adopt_status == "adopted") { document.getElementById("present-status").setAttribute("class", "labelll adopted"); }
					else { document.getElementById("present-status").setAttribute("class", "labelll pending"); }
		        });
		    })
		        .catch(error => console.log('ERROR'));
		
		    // from posts
		    url = site + '/posts?pet_id=' + pet_id;
		    fetch(url)
		    .then(res => res.json())
		    .then(data => {
		        console.log(data);
		        data.forEach(obj => {
		            document.getElementById("present-title").innerHTML       = obj.title;
		            document.getElementById("present-description").innerHTML = obj.description;
		            document.getElementById("present-postby").innerHTML      = obj.username;
		            if ("{{ login }}" != "") { document.getElementById("present-postby").setAttribute("href", "http://coasttocoast.web.illinois.edu/userpage/" + obj.username + "/login/{{ login }}"); }
		            else {                     document.getElementById("present-postby").setAttribute("href", "http://coasttocoast.web.illinois.edu/userpage/" + obj.username); }
		            document.getElementById("present-posttime").innerHTML    = obj.open_time;
				});
		    })

			/*
			var btnRequest = document.createElement("button");
            btnRequest.setAttribute("class", "btn-adopt");
			btnRequest.setAttribute("id", "btn-request");
			btnRequest.setAttribute("onclick", "request()");
			btnRequest.innerHTML = "Request to Adopt";
			document.getElementById("operations").appendChild(btnRequest);

			var btnContact = document.createElement("button");
            btnContact.setAttribute("class", "btn-adopt");
			btnContact.setAttribute("id", "btn-contact");
			btnContact.setAttribute("onclick", "dialog()");
			btnContact.innerHTML = "Send Message";
			document.getElementById("operations").appendChild(btnContact);
			*/
		}

</script>

<script>getPet({{ pet_id }});</script>

</body>
</html>

